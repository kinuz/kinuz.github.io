{"data":{"site":{"siteMetadata":{"title":"Kinuz Blog","subtitle":"","copyright":"Â© All rights reserved.","author":{"name":"Kinuz","twitter":"#"},"disqusShortname":"NuzHome","url":"https://kinuz.netlify.com"}},"markdownRemark":{"id":"22cee2d0-98be-5869-9f02-94252ecf9a65","html":"<ul>\n<li>create yaml file for portainer stack.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.7'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">agent</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> portainer/agent\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">AGENT_CLUSTER_ADDR</span><span class=\"token punctuation\">:</span> tasks.portainer_agent\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n      <span class=\"token punctuation\">-</span> /var/lib/docker/volumes<span class=\"token punctuation\">:</span>/var/lib/docker/volumes\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> portainer<span class=\"token punctuation\">-</span>net\n    <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> global\n  <span class=\"token key atrule\">management</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> portainer/portainer\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span>H tcp<span class=\"token punctuation\">:</span>//tasks.portainer_agent<span class=\"token punctuation\">:</span>9001 <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>tlsskipverify\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">'9000:9000'</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">TZ</span><span class=\"token punctuation\">:</span> Asia/Seoul\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> portainer_data<span class=\"token punctuation\">:</span>/data\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> portainer<span class=\"token punctuation\">-</span>net\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> nginx_config<span class=\"token punctuation\">[</span><span class=\"token string\">'network_name'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> replicated\n      <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n      <span class=\"token key atrule\">placement</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">constraints</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> node.role == manager\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">portainer-net</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> overlay\n\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  portainer_data<span class=\"token punctuation\">:</span></code></pre></div>\n<ul>\n<li>set manager node as working environment</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">eval</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>docker-machine <span class=\"token function\">env</span> myvm1<span class=\"token variable\">)</span></span>\"</span></code></pre></div>\n<ul>\n<li>deploy portainer stack to swarm cluster.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker stack deploy -c portainer.yml portainer\n$ docker <span class=\"token function\">service</span> <span class=\"token function\">ls</span>\n\nID                  NAME                   MODE                REPLICAS            IMAGE                        PORTS\nojmgvlv3ehcf        portainer_agent        global              3/3                 portainer/agent:latest       \nlrjatf7gv6lp        portainer_management   replicated          1/1                 portainer/portainer:latest   *:9000-<span class=\"token operator\">></span>9000/tcp</code></pre></div>\n<ul>\n<li>check docker-machine ip address</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker-machine <span class=\"token function\">ls</span>\nNAME    ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER     ERRORS\nmyvm1   *        virtualbox   Running   tcp://192.168.99.101:2376           v18.09.5   \nmyvm2   -        virtualbox   Running   tcp://192.168.99.102:2376           v18.09.5   \nmyvm3   -        virtualbox   Running   tcp://192.168.99.103:2376           v18.09.5 </code></pre></div>\n<ul>\n<li>visit master node (192.168.99.101) with 9000 port</li>\n</ul>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae8ba8a6cf12404d1d5784185da738b4/72501/portainer-login.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 817px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.485924112607094%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABS0lEQVQoz32S2UrDQBSG+/5PIAjSi1Jjayl9AkHFW71wvbF4I7XZZj2zZWY8k9SuwZ+fw4TMd7ZkUBBeE1oSqo0NMd7dP5xfDIfjbDi+HGWTcTbJprPZfHE9X3Rx2noyX4yupgPOhZQSeYwSwFkbY8QsKBPj0keIybq1jwdCOEmkwDhjlFJCSE0I0Pq5YGffsKzpa0HfS/JRklVVk3qnDbwVAGitlU7Ck9C6Mdo72xn72soYcwwj45xLJIBSymhlnQuxR977A1iINH9VVZi1u4EFcIrg/amxRk/bjDF80cHKeqEsxlNL43oq486aptnALoBF+9ZhZxeEPoFRuOq8KDFFGiyEzo33W+MjCMEJOW7bKnBaNSatSu+pRfaFu7c7mDEOUqxK/rTMHz/zikHj8ILrhNf/2zbCSoqvNbt9W9+8/ORMp1+t9yv9wb8W76mSG8/aSAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"login page\"\n        title=\"\"\n        src=\"/static/ae8ba8a6cf12404d1d5784185da738b4/72501/portainer-login.png\"\n        srcset=\"/static/ae8ba8a6cf12404d1d5784185da738b4/0783d/portainer-login.png 240w,\n/static/ae8ba8a6cf12404d1d5784185da738b4/782f4/portainer-login.png 480w,\n/static/ae8ba8a6cf12404d1d5784185da738b4/72501/portainer-login.png 817w\"\n        sizes=\"(max-width: 817px) 100vw, 817px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><a href=\"https://medium.com/@ismailyenigul/enable-docker-command-line-auto-completion-in-bash-on-centos-ubuntu-5f1ac999a8a6\">https://medium.com/@ismailyenigul/enable-docker-command-line-auto-completion-in-bash-on-centos-ubuntu-5f1ac999a8a6</a></p>","fields":{"tagSlugs":["/tags/docker/"]},"frontmatter":{"title":"Portainer - Making Docker Management Easy.","tags":["docker"],"date":"2019-04-01T23:01:57.000Z","description":"Build and manage your Docker environments with ease today.","refs":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/docker/2019/04/02/portainer-making-docker-management-easy"}}